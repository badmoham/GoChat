version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - DATABASE_URL=postgres://user:password@db:5432/mydb?sslmode=disable
      - DB_HOST=db
      - DB_USER=user
      - DB_PASSWORD=password
      - DB_NAME=mydb
      - JWTSecret=91f631ac235b3716a28727b8e7c62cf82b2bdfb1df46af5632d53492a4ffff740d580d9b11bfb81006934e90864b544f0778b708956fc6ae1878c90a543066eac9978ca9ecea6c70536d76c684e1a61f10496f2ffb564222480c1b53e9dfa42141295e3435fbc74ea15eaf5c9ded4c6bc9e912519b4b04a44985378b2b68351406afe12730308dd727ba89be754d6518498f2049a2458b0744b4d215d77e4c4e9d8674d758432bbdd6714ea8ed4843274b1137df0f30c8d59fa679f6916ca628535f25f7f8ef7c126d26e0b658ce125a07da36cf7a4f7ea52b30a7e5dfc08d83c5bbd7cba162ce5028342eac36aa31b692423e5486ba6aa94872bc4dbf62583b
    depends_on:
      - db
    networks:
      - app-network

  db:
    image: postgres:17-alpine
    restart: always
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mydb
    volumes:
      - db-data:/var/lib/postgresql/data
    networks:
      - app-network

volumes:
  db-data:

networks:
  app-network:
    driver: bridge